{"ast":null,"code":"var carts = {};\nvar restid = 0;\nvar itemAddedToCart = false; // Flag to track whether an item was added to the cart\n\n$(document).ready(function () {\n  initializeCarts();\n});\nfunction initializeCarts() {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = getRestIdFromUrl();\n    updateCartItemCount();\n    updateCart();\n  }\n}\n$(\".submit-order\").click(function () {\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = parseFloat(orderItem.find(\".card-text\").text());\n  var name = orderItem.find(\".foodname\").text();\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n  var item = {\n    q: parseInt(quantity),\n    p: price,\n    n: name\n  };\n  carts[restid][id] = item;\n  itemAddedToCart = true; // Set the flag\n  updateCartItemCount();\n  updateCart();\n  alert(\"Added to cart successfully\");\n});\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  updateCart();\n});\n$(\"#checkout\").click(function () {\n  if (itemAddedToCart) {\n    localStorage.setItem(\"carts\", JSON.stringify(carts));\n    $.ajax({\n      url: \"/resturants/\" + restid + \"/orders\",\n      method: \"POST\",\n      data: {\n        cart_items: carts[restid],\n        authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\")\n      },\n      success: function (response) {\n        delete carts[restid];\n        updateCartItemCount();\n        updateCart();\n        alert(\"Submitted order successfully!\");\n        itemAddedToCart = false; // Reset the flag after checkout\n      },\n\n      error: function (xhr, status, error) {\n        alert(\"Please add items to the cart\");\n      }\n    });\n  }\n});","map":{"version":3,"names":["carts","restid","itemAddedToCart","$","document","ready","initializeCarts","localStorage","getItem","JSON","parse","getRestIdFromUrl","updateCartItemCount","updateCart","click","orderItem","closest","quantity","find","val","id","price","parseFloat","text","name","item","q","parseInt","p","n","alert","on","itemKey","data","setItem","stringify","ajax","url","method","cart_items","authenticity_token","attr","success","response","error","xhr","status"],"sources":["/home/sumitava/rails_practise/zom/zoma/app/javascript/packs/add_to_cart.js"],"sourcesContent":["var carts = {};\nvar restid = 0;\nvar itemAddedToCart = false; // Flag to track whether an item was added to the cart\n\n$(document).ready(function () {\n  initializeCarts();\n});\n\nfunction initializeCarts() {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = getRestIdFromUrl();\n    updateCartItemCount();\n    updateCart();\n  }\n}\n\n$(\".submit-order\").click(function () {\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = parseFloat(orderItem.find(\".card-text\").text());\n  var name = orderItem.find(\".foodname\").text();\n\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n\n  var item = {\n    q: parseInt(quantity),\n    p: price,\n    n: name,\n  };\n  carts[restid][id] = item;\n\n  itemAddedToCart = true; // Set the flag\n  updateCartItemCount();\n  updateCart();\n  alert(\"Added to cart successfully\");\n});\n\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  updateCart();\n});\n\n$(\"#checkout\").click(function () {\n  if (itemAddedToCart) {\n    localStorage.setItem(\"carts\", JSON.stringify(carts));\n\n    $.ajax({\n      url: \"/resturants/\" + restid + \"/orders\",\n      method: \"POST\",\n      data: {\n        cart_items: carts[restid],\n        authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\"),\n      },\n      success: function (response) {\n        delete carts[restid];\n        updateCartItemCount();\n        updateCart();\n        alert(\"Submitted order successfully!\");\n        itemAddedToCart = false; // Reset the flag after checkout\n      },\n      error: function (xhr, status, error) {\n        alert(\"Please add items to the cart\");\n      },\n    });\n  }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}