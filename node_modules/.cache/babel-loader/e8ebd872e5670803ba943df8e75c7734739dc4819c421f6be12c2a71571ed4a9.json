{"ast":null,"code":"var carts = {};\nvar restid = 0;\nvar itemAddedToCart = false;\n$(document).ready(function () {\n  initializeCarts();\n});\nfunction initializeCarts() {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = getRestIdFromUrl();\n    updateCartItemCount();\n    updateCart();\n  }\n}\nfunction getRestIdFromUrl() {\n  var urlParts = window.location.pathname.split(\"/\");\n  var restIdIndex = urlParts.indexOf(\"resturants\") + 1;\n  return urlParts[restIdIndex];\n}\n$(\".submit-order\").click(function () {\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = parseFloat(orderItem.find(\".card-text\").text());\n  var name = orderItem.find(\".foodname\").text();\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n  var item = {\n    q: parseInt(quantity),\n    p: price,\n    n: name\n  };\n  carts[restid][id] = item;\n  itemAddedToCart = true;\n  updateCartItemCount();\n  updateCart();\n  alert(\"Added to cart successfully\");\n});\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  $('#' + itemKey).remove();\n  updateCart();\n});\nfunction updateCartItemCount() {\n  var cartItemCount = carts[restid] ? Object.keys(carts[restid]).length : 0;\n  $(\"#cart-item-count\").text(cartItemCount);\n}\n$(document).on(\"click\", \".quantity-btn\", function () {\n  console.log(\"hi\");\n  var orderItem = $(this).closest(\".order-item\");\n  var quantityInput = orderItem.find(\".order-quantity\");\n  var currentQuantity = parseInt(quantityInput.val());\n  if ($(this).hasClass(\"plus\")) {\n    quantityInput.val(currentQuantity + 1);\n    console.log(currentQuantity);\n  } else if ($(this).hasClass(\"minus\") && currentQuantity > 1) {\n    quantityInput.val(currentQuantity - 1);\n  }\n  var itemKey = $(this).closest(\".cart-item\").attr(\"id\");\n  var restId = $(this).closest(\".order-item\").find(\".restid\").text();\n  console.log(carts[restId][itemKey]);\n  carts[restId][itemKey].q = quantityInput.val();\n  updateCart();\n});\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach(itemKey => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n      var cartItemHtml = '<div class=\"cart-item shadow p-3 mb-5 bg-body rounded\" id=\"' + itemKey + '\">' + '<li class=\"list-group-item\">Food Name: <strong>' + item.n + \"</strong></li>\" + '<li class=\"list-group-item\">Quantity: ' + '<span class=\"quantity-control\">' + '<button class=\"quantity-btn minus\">-</button>' + '<input type=\"number\" class=\"order-quantity\" value=\"' + item.q + '\" min=\"1\" readonly>' + '<button class=\"quantity-btn plus\">+</button>' + '</span>' + \"</li>\" + '<li class=\"list-group-item\"> <strong> Price: Rs.' + itemPrice.toFixed(2) + \"</strong></li>\" + '<button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"' + itemKey + '\">Remove</button>' + \"</div>\";\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(\"Rs \" + totalPrice.toFixed(2));\n  updateCartItemCount();\n}\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $.ajax({\n    url: \"/resturants/\" + restid + \"/orders\",\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\")\n    },\n    success: function (response) {\n      delete carts[restid];\n      updateCartItemCount();\n      updateCart();\n      alert(\"Submitted order successfully!\");\n    },\n    error: function (xhr, status, error) {\n      alert(\"Please add items to the cart\");\n    }\n  });\n});","map":{"version":3,"names":["carts","restid","itemAddedToCart","$","document","ready","initializeCarts","localStorage","getItem","JSON","parse","getRestIdFromUrl","updateCartItemCount","updateCart","urlParts","window","location","pathname","split","restIdIndex","indexOf","click","orderItem","closest","quantity","find","val","id","price","parseFloat","text","name","item","q","parseInt","p","n","alert","on","itemKey","data","remove","cartItemCount","Object","keys","length","console","log","quantityInput","currentQuantity","hasClass","attr","restId","setItem","stringify","empty","totalQuantity","totalPrice","forEach","itemPrice","cartItemHtml","toFixed","append","ajax","url","method","cart_items","authenticity_token","success","response","error","xhr","status"],"sources":["/home/sumitava/rails_practise/zom/zoma/app/javascript/packs/add_to_cart.js"],"sourcesContent":["var carts = {};\nvar restid = 0;\nvar itemAddedToCart = false;\n\n$(document).ready(function () {\n  initializeCarts();\n});\n\nfunction initializeCarts() {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = getRestIdFromUrl();\n    updateCartItemCount();\n    updateCart();\n  }\n}\n\nfunction getRestIdFromUrl() {\n  var urlParts = window.location.pathname.split(\"/\");\n  var restIdIndex = urlParts.indexOf(\"resturants\") + 1;\n  return urlParts[restIdIndex];\n}\n\n$(\".submit-order\").click(function () {\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = parseFloat(orderItem.find(\".card-text\").text());\n  var name = orderItem.find(\".foodname\").text();\n\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n\n  var item = {\n    q: parseInt(quantity),\n    p: price,\n    n: name,\n  };\n  carts[restid][id] = item;\n\n  itemAddedToCart = true;\n  updateCartItemCount();\n  updateCart();\n  alert(\"Added to cart successfully\");\n});\n\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  $('#' + itemKey).remove();\n  updateCart()\n});\n\nfunction updateCartItemCount() {\n  var cartItemCount = carts[restid] ? Object.keys(carts[restid]).length : 0;\n  $(\"#cart-item-count\").text(cartItemCount);\n}\n\n$(document).on(\"click\", \".quantity-btn\", function () {\n  console.log(\"hi\") \n  var orderItem = $(this).closest(\".order-item\");\n  var quantityInput = orderItem.find(\".order-quantity\");\n  var currentQuantity = parseInt(quantityInput.val());\n\n  if ($(this).hasClass(\"plus\")) {\n    quantityInput.val(currentQuantity + 1);\n    console.log(currentQuantity);\n  } else if ($(this).hasClass(\"minus\") && currentQuantity > 1) {\n    quantityInput.val(currentQuantity - 1);\n  }\n\n  var itemKey = $(this).closest(\".cart-item\").attr(\"id\");\n  var restId = $(this).closest(\".order-item\").find(\".restid\").text();\n  console.log(carts[restId][itemKey])\n  carts[restId][itemKey].q = quantityInput.val();\n\n  updateCart();\n});\n\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach((itemKey) => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n\n      var cartItemHtml =\n      '<div class=\"cart-item shadow p-3 mb-5 bg-body rounded\" id=\"' + itemKey + '\">' +\n      '<li class=\"list-group-item\">Food Name: <strong>' +\n      item.n +\n      \"</strong></li>\" +\n      '<li class=\"list-group-item\">Quantity: ' +\n      '<span class=\"quantity-control\">' +\n      '<button class=\"quantity-btn minus\">-</button>' +\n      '<input type=\"number\" class=\"order-quantity\" value=\"' + item.q + '\" min=\"1\" readonly>' +\n      '<button class=\"quantity-btn plus\">+</button>' +\n      '</span>' +\n      \"</li>\" +\n      '<li class=\"list-group-item\"> <strong> Price: Rs.' +\n      itemPrice.toFixed(2) +\n      \"</strong></li>\" +\n      '<button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"' +\n      itemKey +\n      '\">Remove</button>' +\n      \"</div>\";\n\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(\"Rs \" + totalPrice.toFixed(2));\n\n  updateCartItemCount();\n}\n\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n\n  $.ajax({\n    url: \"/resturants/\" + restid + \"/orders\",\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\"),\n    },\n    success: function (response) {\n      delete carts[restid];\n      updateCartItemCount();\n      updateCart();\n      alert(\"Submitted order successfully!\");\n    },\n    error: function (xhr, status, error) {\n      alert(\"Please add items to the cart\");\n    },\n  });\n});\n"],"mappings":"AAAA,IAAIA,KAAK,GAAG,CAAC,CAAC;AACd,IAAIC,MAAM,GAAG,CAAC;AACd,IAAIC,eAAe,GAAG,KAAK;AAE3BC,CAAC,CAACC,QAAQ,CAAC,CAACC,KAAK,CAAC,YAAY;EAC5BC,eAAe,CAAC,CAAC;AACnB,CAAC,CAAC;AAEF,SAASA,eAAeA,CAAA,EAAG;EACzB,IAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAE;IACjCR,KAAK,GAAGS,IAAI,CAACC,KAAK,CAACH,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;IACjDP,MAAM,GAAGU,gBAAgB,CAAC,CAAC;IAC3BC,mBAAmB,CAAC,CAAC;IACrBC,UAAU,CAAC,CAAC;EACd;AACF;AAEA,SAASF,gBAAgBA,CAAA,EAAG;EAC1B,IAAIG,QAAQ,GAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC;EAClD,IAAIC,WAAW,GAAGL,QAAQ,CAACM,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;EACpD,OAAON,QAAQ,CAACK,WAAW,CAAC;AAC9B;AAEAhB,CAAC,CAAC,eAAe,CAAC,CAACkB,KAAK,CAAC,YAAY;EACnC,IAAIC,SAAS,GAAGnB,CAAC,CAAC,IAAI,CAAC,CAACoB,OAAO,CAAC,aAAa,CAAC;EAC9C,IAAIC,QAAQ,GAAGF,SAAS,CAACG,IAAI,CAAC,iBAAiB,CAAC,CAACC,GAAG,CAAC,CAAC;EACtD,IAAIC,EAAE,GAAGL,SAAS,CAACG,IAAI,CAAC,eAAe,CAAC,CAACC,GAAG,CAAC,CAAC;EAC9C,IAAIE,KAAK,GAAGC,UAAU,CAACP,SAAS,CAACG,IAAI,CAAC,YAAY,CAAC,CAACK,IAAI,CAAC,CAAC,CAAC;EAC3D,IAAIC,IAAI,GAAGT,SAAS,CAACG,IAAI,CAAC,WAAW,CAAC,CAACK,IAAI,CAAC,CAAC;EAE7C,IAAI,CAAC9B,KAAK,CAACC,MAAM,CAAC,EAAE;IAClBD,KAAK,CAACC,MAAM,CAAC,GAAG,CAAC,CAAC;EACpB;EAEA,IAAI+B,IAAI,GAAG;IACTC,CAAC,EAAEC,QAAQ,CAACV,QAAQ,CAAC;IACrBW,CAAC,EAAEP,KAAK;IACRQ,CAAC,EAAEL;EACL,CAAC;EACD/B,KAAK,CAACC,MAAM,CAAC,CAAC0B,EAAE,CAAC,GAAGK,IAAI;EAExB9B,eAAe,GAAG,IAAI;EACtBU,mBAAmB,CAAC,CAAC;EACrBC,UAAU,CAAC,CAAC;EACZwB,KAAK,CAAC,4BAA4B,CAAC;AACrC,CAAC,CAAC;AAEFlC,CAAC,CAACC,QAAQ,CAAC,CAACkC,EAAE,CAAC,OAAO,EAAE,cAAc,EAAE,YAAY;EAClD,IAAIC,OAAO,GAAGpC,CAAC,CAAC,IAAI,CAAC,CAACqC,IAAI,CAAC,UAAU,CAAC;EACtC,OAAOxC,KAAK,CAACC,MAAM,CAAC,CAACsC,OAAO,CAAC;EAC7BpC,CAAC,CAAC,GAAG,GAAGoC,OAAO,CAAC,CAACE,MAAM,CAAC,CAAC;EACzB5B,UAAU,CAAC,CAAC;AACd,CAAC,CAAC;AAEF,SAASD,mBAAmBA,CAAA,EAAG;EAC7B,IAAI8B,aAAa,GAAG1C,KAAK,CAACC,MAAM,CAAC,GAAG0C,MAAM,CAACC,IAAI,CAAC5C,KAAK,CAACC,MAAM,CAAC,CAAC,CAAC4C,MAAM,GAAG,CAAC;EACzE1C,CAAC,CAAC,kBAAkB,CAAC,CAAC2B,IAAI,CAACY,aAAa,CAAC;AAC3C;AAEAvC,CAAC,CAACC,QAAQ,CAAC,CAACkC,EAAE,CAAC,OAAO,EAAE,eAAe,EAAE,YAAY;EACnDQ,OAAO,CAACC,GAAG,CAAC,IAAI,CAAC;EACjB,IAAIzB,SAAS,GAAGnB,CAAC,CAAC,IAAI,CAAC,CAACoB,OAAO,CAAC,aAAa,CAAC;EAC9C,IAAIyB,aAAa,GAAG1B,SAAS,CAACG,IAAI,CAAC,iBAAiB,CAAC;EACrD,IAAIwB,eAAe,GAAGf,QAAQ,CAACc,aAAa,CAACtB,GAAG,CAAC,CAAC,CAAC;EAEnD,IAAIvB,CAAC,CAAC,IAAI,CAAC,CAAC+C,QAAQ,CAAC,MAAM,CAAC,EAAE;IAC5BF,aAAa,CAACtB,GAAG,CAACuB,eAAe,GAAG,CAAC,CAAC;IACtCH,OAAO,CAACC,GAAG,CAACE,eAAe,CAAC;EAC9B,CAAC,MAAM,IAAI9C,CAAC,CAAC,IAAI,CAAC,CAAC+C,QAAQ,CAAC,OAAO,CAAC,IAAID,eAAe,GAAG,CAAC,EAAE;IAC3DD,aAAa,CAACtB,GAAG,CAACuB,eAAe,GAAG,CAAC,CAAC;EACxC;EAEA,IAAIV,OAAO,GAAGpC,CAAC,CAAC,IAAI,CAAC,CAACoB,OAAO,CAAC,YAAY,CAAC,CAAC4B,IAAI,CAAC,IAAI,CAAC;EACtD,IAAIC,MAAM,GAAGjD,CAAC,CAAC,IAAI,CAAC,CAACoB,OAAO,CAAC,aAAa,CAAC,CAACE,IAAI,CAAC,SAAS,CAAC,CAACK,IAAI,CAAC,CAAC;EAClEgB,OAAO,CAACC,GAAG,CAAC/C,KAAK,CAACoD,MAAM,CAAC,CAACb,OAAO,CAAC,CAAC;EACnCvC,KAAK,CAACoD,MAAM,CAAC,CAACb,OAAO,CAAC,CAACN,CAAC,GAAGe,aAAa,CAACtB,GAAG,CAAC,CAAC;EAE9Cb,UAAU,CAAC,CAAC;AACd,CAAC,CAAC;AAEF,SAASA,UAAUA,CAAA,EAAG;EACpBN,YAAY,CAAC8C,OAAO,CAAC,OAAO,EAAE5C,IAAI,CAAC6C,SAAS,CAACtD,KAAK,CAAC,CAAC;EACpDG,CAAC,CAAC,aAAa,CAAC,CAACoD,KAAK,CAAC,CAAC;EACxB,IAAIC,aAAa,GAAG,CAAC;EACrB,IAAIC,UAAU,GAAG,CAAC;EAElB,IAAIzD,KAAK,CAACC,MAAM,CAAC,EAAE;IACjB0C,MAAM,CAACC,IAAI,CAAC5C,KAAK,CAACC,MAAM,CAAC,CAAC,CAACyD,OAAO,CAAEnB,OAAO,IAAK;MAC9C,IAAIP,IAAI,GAAGhC,KAAK,CAACC,MAAM,CAAC,CAACsC,OAAO,CAAC;MACjC,IAAIoB,SAAS,GAAG3B,IAAI,CAACC,CAAC,GAAGD,IAAI,CAACG,CAAC;MAC/BqB,aAAa,IAAIxB,IAAI,CAACC,CAAC;MACvBwB,UAAU,IAAIE,SAAS;MAEvB,IAAIC,YAAY,GAChB,6DAA6D,GAAGrB,OAAO,GAAG,IAAI,GAC9E,iDAAiD,GACjDP,IAAI,CAACI,CAAC,GACN,gBAAgB,GAChB,wCAAwC,GACxC,iCAAiC,GACjC,+CAA+C,GAC/C,qDAAqD,GAAGJ,IAAI,CAACC,CAAC,GAAG,qBAAqB,GACtF,8CAA8C,GAC9C,SAAS,GACT,OAAO,GACP,kDAAkD,GAClD0B,SAAS,CAACE,OAAO,CAAC,CAAC,CAAC,GACpB,gBAAgB,GAChB,mEAAmE,GACnEtB,OAAO,GACP,mBAAmB,GACnB,QAAQ;MAERpC,CAAC,CAAC,aAAa,CAAC,CAAC2D,MAAM,CAACF,YAAY,CAAC;IACvC,CAAC,CAAC;EACJ;EAEAzD,CAAC,CAAC,iBAAiB,CAAC,CAAC2B,IAAI,CAAC0B,aAAa,CAAC;EACxCrD,CAAC,CAAC,cAAc,CAAC,CAAC2B,IAAI,CAAC,KAAK,GAAG2B,UAAU,CAACI,OAAO,CAAC,CAAC,CAAC,CAAC;EAErDjD,mBAAmB,CAAC,CAAC;AACvB;AAEAT,CAAC,CAAC,WAAW,CAAC,CAACkB,KAAK,CAAC,YAAY;EAC/Bd,YAAY,CAAC8C,OAAO,CAAC,OAAO,EAAE5C,IAAI,CAAC6C,SAAS,CAACtD,KAAK,CAAC,CAAC;EAEpDG,CAAC,CAAC4D,IAAI,CAAC;IACLC,GAAG,EAAE,cAAc,GAAG/D,MAAM,GAAG,SAAS;IACxCgE,MAAM,EAAE,MAAM;IACdzB,IAAI,EAAE;MACJ0B,UAAU,EAAElE,KAAK,CAACC,MAAM,CAAC;MACzBkE,kBAAkB,EAAEhE,CAAC,CAAC,yBAAyB,CAAC,CAACgD,IAAI,CAAC,SAAS;IACjE,CAAC;IACDiB,OAAO,EAAE,SAAAA,CAAUC,QAAQ,EAAE;MAC3B,OAAOrE,KAAK,CAACC,MAAM,CAAC;MACpBW,mBAAmB,CAAC,CAAC;MACrBC,UAAU,CAAC,CAAC;MACZwB,KAAK,CAAC,+BAA+B,CAAC;IACxC,CAAC;IACDiC,KAAK,EAAE,SAAAA,CAAUC,GAAG,EAAEC,MAAM,EAAEF,KAAK,EAAE;MACnCjC,KAAK,CAAC,8BAA8B,CAAC;IACvC;EACF,CAAC,CAAC;AACJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}