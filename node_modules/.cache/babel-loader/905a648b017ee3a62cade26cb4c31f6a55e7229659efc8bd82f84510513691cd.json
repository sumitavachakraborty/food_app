{"ast":null,"code":"var carts = {};\nvar restid = 0;\n$(document).ready(function () {\n  initializeCarts();\n});\nfunction initializeCarts() {\n  carts = JSON.parse(localStorage.getItem(\"carts\")) || {};\n  restid = getRestIdFromUrl();\n  updateCartItemCount();\n}\nfunction getRestIdFromUrl() {\n  var urlParts = window.location.pathname.split(\"/\");\n  var restIdIndex = urlParts.indexOf(\"resturants\") + 1;\n  return urlParts[restIdIndex];\n}\n$(\"#cart-btn\").click(updateCart);\n$(\".submit-order\").click(function () {\n  $(\"#submit-cart\").removeAttr(\"style\");\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = orderItem.find(\".card-text\").text();\n  var name = orderItem.find(\".foodname\").text();\n  updateCartItem(id, {\n    q: quantity,\n    p: price,\n    n: name\n  });\n  updateCart();\n  increaseCartItemCount();\n});\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  deleteCartItem(itemKey);\n  updateCart();\n});\nfunction updateCartItem(key, item) {\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n  carts[restid][key] = item;\n}\nfunction deleteCartItem(key) {\n  if (carts[restid]) {\n    delete carts[restid][key];\n  }\n}\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach(itemKey => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n      var cartItemHtml = `\n        <div class=\"cart-item shadow p-3 mb-5 bg-body rounded\">\n          <li class=\"list-group-item\">Food Name: <strong>${item.n}</strong></li>\n          <li class=\"list-group-item\">Quantity: ${item.q}</li>\n          <li class=\"list-group-item\"> <strong> Price: Rs.${itemPrice}</strong></li>\n          <button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"${itemKey}\">Remove</button>\n        </div>\n      `;\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(`Rs${totalPrice.toFixed(2)}`);\n  updateCartItemCount();\n}\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  sessionStorage.removeItem(\"cart\");\n  $.ajax({\n    url: `/resturants/${restid}/orders`,\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\")\n    },\n    success: function (response) {\n      alert(\"Added to cart successfully!\");\n      updateCartItemCount();\n      delete carts[restid];\n      localStorage.setItem(\"carts\", JSON.stringify(carts));\n    },\n    error: function (xhr, status, error) {\n      alert(\"Please add items to the cart\");\n    }\n  });\n});","map":{"version":3,"names":["carts","restid","$","document","ready","initializeCarts","JSON","parse","localStorage","getItem","getRestIdFromUrl","updateCartItemCount","urlParts","window","location","pathname","split","restIdIndex","indexOf","click","updateCart","removeAttr","orderItem","closest","quantity","find","val","id","price","text","name","updateCartItem","q","p","n","increaseCartItemCount","on","itemKey","data","deleteCartItem","key","item","setItem","stringify","empty","totalQuantity","totalPrice","Object","keys","forEach","itemPrice","cartItemHtml","append","toFixed","sessionStorage","removeItem","ajax","url","method","cart_items","authenticity_token","attr","success","response","alert","error","xhr","status"],"sources":["/home/sumitava/rails_practise/zom/zoma/app/javascript/packs/add_to_cart.js"],"sourcesContent":["var carts = {};\nvar restid = 0;\n\n$(document).ready(function () {\n  initializeCarts();\n});\n\nfunction initializeCarts() {\n  carts = JSON.parse(localStorage.getItem(\"carts\")) || {};\n  restid = getRestIdFromUrl();\n  updateCartItemCount();\n}\n\nfunction getRestIdFromUrl() {\n  var urlParts = window.location.pathname.split(\"/\");\n  var restIdIndex = urlParts.indexOf(\"resturants\") + 1;\n  return urlParts[restIdIndex];\n}\n\n$(\"#cart-btn\").click(updateCart);\n\n$(\".submit-order\").click(function () {\n  $(\"#submit-cart\").removeAttr(\"style\");\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = orderItem.find(\".card-text\").text();\n  var name = orderItem.find(\".foodname\").text();\n\n  updateCartItem(id, { q: quantity, p: price, n: name });\n  updateCart();\n  increaseCartItemCount();\n});\n\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  deleteCartItem(itemKey);\n  updateCart();\n});\n\nfunction updateCartItem(key, item) {\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n  carts[restid][key] = item;\n}\n\nfunction deleteCartItem(key) {\n  if (carts[restid]) {\n    delete carts[restid][key];\n  }\n}\n\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach((itemKey) => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n\n      var cartItemHtml = `\n        <div class=\"cart-item shadow p-3 mb-5 bg-body rounded\">\n          <li class=\"list-group-item\">Food Name: <strong>${item.n}</strong></li>\n          <li class=\"list-group-item\">Quantity: ${item.q}</li>\n          <li class=\"list-group-item\"> <strong> Price: Rs.${itemPrice}</strong></li>\n          <button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"${itemKey}\">Remove</button>\n        </div>\n      `;\n\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(`Rs${totalPrice.toFixed(2)}`);\n\n  updateCartItemCount();\n}\n\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  sessionStorage.removeItem(\"cart\");\n\n  $.ajax({\n    url: `/resturants/${restid}/orders`,\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\"),\n    },\n    success: function (response) {\n      alert(\"Added to cart successfully!\");\n      updateCartItemCount();\n      delete carts[restid];\n      localStorage.setItem(\"carts\", JSON.stringify(carts));\n    },\n    error: function (xhr, status, error) {\n      alert(\"Please add items to the cart\");\n    },\n  });\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}