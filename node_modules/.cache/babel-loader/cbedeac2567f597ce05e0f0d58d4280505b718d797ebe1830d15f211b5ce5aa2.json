{"ast":null,"code":"var carts = {};\nvar restid = 0;\n$(document).ready(function () {\n  initializeCarts();\n  updateConfirmButtonStatus();\n});\nfunction getRestIdFromUrl() {\n  var urlParts = window.location.pathname.split(\"/\");\n  var restIdIndex = urlParts.indexOf(\"restaurants\") + 1;\n  return urlParts[restIdIndex];\n}\nfunction showAlert(message) {\n  const alertContainer = document.getElementById('alert-container');\n  const alertElement = document.createElement('div');\n  alertElement.className = 'alertcart alert-primary';\n  alertElement.textContent = message;\n  alertContainer.appendChild(alertElement);\n  setTimeout(() => {\n    alertContainer.removeChild(alertElement);\n  }, 2000);\n}\n$(document).ready(function () {\n  $(\".submit-order\").click(function () {\n    var orderItem = $(this).closest(\".order-item\");\n    var quantity = orderItem.find(\".order-quantity\").val();\n    var id = $(this).val();\n    var price = parseFloat(orderItem.find(\".card-text\").text());\n    var name = orderItem.find(\".foodname\").text();\n    if (!carts[restid]) {\n      carts[restid] = {};\n      showAlert(`Successfully added ${name} to cart`);\n    } else if (!carts[restid][id]) {\n      showAlert(`Successfully added ${name} to cart`);\n    } else {\n      showAlert(\"Item already added in the cart\");\n    }\n    var item = {\n      q: parseInt(quantity),\n      p: price,\n      n: name\n    };\n    carts[restid][id] = item;\n    updateCartItemCount();\n    updateCart();\n    updateConfirmButtonStatus();\n    console.log(\"end ininitalization\");\n  });\n});\nfunction initializeCarts() {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = getRestIdFromUrl();\n    updateCartItemCount();\n    updateCart();\n  }\n}\nfunction updateConfirmButtonStatus() {\n  var cartItemCount = carts[restid] ? Object.keys(carts[restid]).length : 0;\n  var confirmButton = $(\"#checkout\");\n  if (cartItemCount > 0) {\n    confirmButton.prop(\"disabled\", false);\n    confirmButton.text(\"Confirm items\");\n  } else {\n    confirmButton.prop(\"disabled\", true);\n    confirmButton.text(\"Add some items\");\n  }\n}\n$(\".remove-item\").click(function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  $(\"#\" + itemKey).remove();\n  updateCartItemCount();\n  updateCart();\n  updateConfirmButtonStatus();\n});\n$(document).on(\"input\", \".order-quantity\", function () {\n  var newQuantity = parseInt($(this).val());\n  var itemKey = $(this).data(\"item-key\");\n  if (carts[restid] && carts[restid][itemKey]) {\n    var item = carts[restid][itemKey];\n    item.q = newQuantity;\n    var itemPrice = item.q * item.p;\n    $(this).closest(\".cart-item\").find(\".item-price\").text(\"Price: Rs. \" + itemPrice.toFixed(2));\n    updateCartItemCount();\n    updateCart();\n    updateConfirmButtonStatus();\n  }\n});\nfunction updateCartItemCount() {\n  var cartItemCount = carts[restid] ? Object.keys(carts[restid]).length : 0;\n  if (cartItemCount == 0) carts[restid] = {};\n  $(\"#cart-item-count\").text(cartItemCount);\n}\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach(itemKey => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n      var cartItemHtml = `\n          <div class=\"cart-item shadow p-3 mb-5 bg-body rounded\" id=\"${itemKey}\">\n            <li class=\"list-group-item\">Food Name: <strong>${item.n}</strong></li>\n            <div class=\"quantity-input\">\n              Quantity: \n              <input type=\"number\" class=\"order-quantity\" value=\"${item.q}\" min=\"1\" max=\"20\" data-item-key=\"${itemKey}\" onkeydown=\"return false\">\n            </div>\n            <li class=\"list-group-item\">Price: Rs. ${itemPrice.toFixed(2)}</li>\n            <button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"${itemKey}\">Remove</button>\n          </div>`;\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(\"Total Price: Rs \" + totalPrice.toFixed(2));\n  updateCartItemCount();\n}\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $.ajax({\n    url: \"/restaurants/\" + restid + \"/orders\",\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\")\n    },\n    success: function (response) {\n      delete carts[restid];\n      updateCartItemCount();\n      updateCart();\n    },\n    error: function (xhr, status, error) {\n      showAlert(\"Please, add items to the cart\");\n    }\n  });\n});","map":{"version":3,"names":["carts","restid","$","document","ready","initializeCarts","updateConfirmButtonStatus","getRestIdFromUrl","urlParts","window","location","pathname","split","restIdIndex","indexOf","showAlert","message","alertContainer","getElementById","alertElement","createElement","className","textContent","appendChild","setTimeout","removeChild","click","orderItem","closest","quantity","find","val","id","price","parseFloat","text","name","item","q","parseInt","p","n","updateCartItemCount","updateCart","console","log","localStorage","getItem","JSON","parse","cartItemCount","Object","keys","length","confirmButton","prop","itemKey","data","remove","on","newQuantity","itemPrice","toFixed","setItem","stringify","empty","totalQuantity","totalPrice","forEach","cartItemHtml","append","ajax","url","method","cart_items","authenticity_token","attr","success","response","error","xhr","status"],"sources":["/home/sumitava/rails_practise/zom/zoma/app/javascript/packs/add_to_cart.js"],"sourcesContent":["var carts = {};\nvar restid = 0;\n$(document).ready(function () {\n  initializeCarts();\n  updateConfirmButtonStatus();\n});\n\nfunction getRestIdFromUrl() {\n  var urlParts = window.location.pathname.split(\"/\");\n  var restIdIndex = urlParts.indexOf(\"restaurants\") + 1;\n  return urlParts[restIdIndex];\n}\nfunction showAlert(message) {\n  const alertContainer = document.getElementById('alert-container');\n  const alertElement = document.createElement('div');\n  alertElement.className = 'alertcart alert-primary'; \n  alertElement.textContent = message;\n\n  alertContainer.appendChild(alertElement);\n  setTimeout(() => {\n      alertContainer.removeChild(alertElement);\n  }, 2000);\n}\n$(document).ready(function () {\n  $(\".submit-order\").click( function () {\n    var orderItem = $(this).closest(\".order-item\");\n    var quantity = orderItem.find(\".order-quantity\").val();\n    var id = $(this).val();\n    var price = parseFloat(orderItem.find(\".card-text\").text());\n    var name = orderItem.find(\".foodname\").text();\n\n    if (!carts[restid]) {\n      carts[restid] = {};\n      showAlert(`Successfully added ${name} to cart`);\n    } else if (!carts[restid][id]) {\n      showAlert(`Successfully added ${name} to cart`);\n    } else{\n      showAlert(\"Item already added in the cart\");\n    }\n    \n    var item = {\n      q: parseInt(quantity),\n      p: price,\n      n: name,\n    };\n    carts[restid][id] = item;\n    \n\n    updateCartItemCount();\n    updateCart();\n    updateConfirmButtonStatus();\n    console.log(\"end ininitalization\");\n  });\n});\nfunction initializeCarts() {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = getRestIdFromUrl();\n    updateCartItemCount();\n    updateCart();\n  }\n}\nfunction updateConfirmButtonStatus() {\n  var cartItemCount = carts[restid] ? Object.keys(carts[restid]).length : 0;\n  var confirmButton = $(\"#checkout\");\n\n  if (cartItemCount > 0) {\n    confirmButton.prop(\"disabled\", false);\n    confirmButton.text(\"Confirm items\");\n  } else {\n    confirmButton.prop(\"disabled\", true);\n    confirmButton.text(\"Add some items\");\n  }\n}\n$(\".remove-item\").click(function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  $(\"#\" + itemKey).remove();\n  updateCartItemCount();\n  updateCart();\n  updateConfirmButtonStatus();\n});\n\n$(document).on(\"input\", \".order-quantity\", function () {\n  var newQuantity = parseInt($(this).val());\n  var itemKey = $(this).data(\"item-key\");\n\n  if (carts[restid] && carts[restid][itemKey]) {\n    var item = carts[restid][itemKey];\n    item.q = newQuantity;\n\n    var itemPrice = item.q * item.p;\n    $(this)\n      .closest(\".cart-item\")\n      .find(\".item-price\")\n      .text(\"Price: Rs. \" + itemPrice.toFixed(2));\n\n    updateCartItemCount();\n    updateCart();\n    updateConfirmButtonStatus();\n  }\n});\n\nfunction updateCartItemCount() {\n  var cartItemCount = carts[restid] ? Object.keys(carts[restid]).length : 0;\n  if(cartItemCount==0) carts[restid] = {}\n  $(\"#cart-item-count\").text(cartItemCount);\n}\n\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach((itemKey) => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n\n      var cartItemHtml = `\n          <div class=\"cart-item shadow p-3 mb-5 bg-body rounded\" id=\"${itemKey}\">\n            <li class=\"list-group-item\">Food Name: <strong>${\n              item.n\n            }</strong></li>\n            <div class=\"quantity-input\">\n              Quantity: \n              <input type=\"number\" class=\"order-quantity\" value=\"${\n                item.q\n              }\" min=\"1\" max=\"20\" data-item-key=\"${itemKey}\" onkeydown=\"return false\">\n            </div>\n            <li class=\"list-group-item\">Price: Rs. ${itemPrice.toFixed(2)}</li>\n            <button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"${itemKey}\">Remove</button>\n          </div>`;\n\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(\"Total Price: Rs \" + totalPrice.toFixed(2));\n\n  updateCartItemCount();\n}\n\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $.ajax({\n    url: \"/restaurants/\" + restid + \"/orders\",\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\"),\n    },\n    success: function (response) {\n      delete carts[restid];\n      updateCartItemCount();\n      updateCart();\n    },\n    error: function (xhr, status, error) {\n      showAlert(\"Please, add items to the cart\");\n    },\n  });\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}