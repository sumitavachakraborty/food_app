{"ast":null,"code":"var carts = {};\nvar restid = 0;\n$(document).ready(function () {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = $(\".restid\").text();\n    console.log(restid);\n    updateCartItemCount();\n  }\n});\n\n// function getRestIdFromUrl() {\n//   var urlParts = window.location.pathname.split(\"/\");\n//   var restIdIndex = urlParts.indexOf(\"resturants\") + 1;\n//   return urlParts[restIdIndex];\n// }\n\n$(\"#cart-btn\").click(function () {\n  updateCart();\n});\nfunction updateCartItemCount() {\n  var cartItemCount = 0;\n  if (carts[restid]) {\n    cartItemCount = Object.keys(carts[restid]).length;\n  }\n  $(\"#cart-item-count\").text(cartItemCount);\n}\n$(\".submit-order\").click(function () {\n  $(\"#submit-cart\").removeAttr(\"style\");\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = orderItem.find(\".card-text\").text();\n  var name = orderItem.find(\".foodname\").text();\n  restid = orderItem.find(\".restid\").text();\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n  var item = {\n    q: quantity,\n    p: price,\n    n: name\n  };\n  carts[restid][id] = item;\n  updateCart();\n  increaseCartItemCount();\n});\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  updateCart();\n});\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach(itemKey => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n      var cartItemHtml = '<div class=\"cart-item shadow p-3 mb-5 bg-body rounded\">' + '<li class=\"list-group-item\">Food Name: <strong>' + item.n + \"</strong></li>\" + '<li class=\"list-group-item\">Quantity: ' + item.q + \"</li>\" + '<li class=\"list-group-item\"> <strong> Price: Rs.' + itemPrice + \"</strong></li>\" + '<button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"' + itemKey + '\">Remove</button>' + \"</div>\";\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(\"Rs\" + totalPrice.toFixed(2));\n  updateCartItemCount();\n}\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  sessionStorage.removeItem(\"cart\");\n  $.ajax({\n    url: \"/resturants/\" + restid + \"/orders\",\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\")\n    },\n    success: function (response) {\n      alert(\"Added to cart successfully!\");\n      updateCartItemCount();\n      delete carts[restid];\n      localStorage.setItem(\"carts\", JSON.stringify(carts));\n    },\n    error: function (xhr, status, error) {\n      alert(\"Please add items to the cart\");\n    }\n  });\n});","map":{"version":3,"names":["carts","restid","$","document","ready","localStorage","getItem","JSON","parse","text","console","log","updateCartItemCount","click","updateCart","cartItemCount","Object","keys","length","removeAttr","orderItem","closest","quantity","find","val","id","price","name","item","q","p","n","increaseCartItemCount","on","itemKey","data","setItem","stringify","empty","totalQuantity","totalPrice","forEach","itemPrice","cartItemHtml","append","toFixed","sessionStorage","removeItem","ajax","url","method","cart_items","authenticity_token","attr","success","response","alert","error","xhr","status"],"sources":["/home/sumitava/rails_practise/zom/zoma/app/javascript/packs/add_to_cart.js"],"sourcesContent":["var carts = {};\nvar restid = 0;\n$(document).ready(function () {\n  if (localStorage.getItem(\"carts\")) {\n    carts = JSON.parse(localStorage.getItem(\"carts\"));\n    restid = $(\".restid\").text();\n    console.log(restid)\n    updateCartItemCount();\n  }\n});\n\n// function getRestIdFromUrl() {\n//   var urlParts = window.location.pathname.split(\"/\");\n//   var restIdIndex = urlParts.indexOf(\"resturants\") + 1;\n//   return urlParts[restIdIndex];\n// }\n\n$(\"#cart-btn\").click(function () {\n  updateCart();\n});\n\nfunction updateCartItemCount() {\n  var cartItemCount = 0;\n  if (carts[restid]) {\n    cartItemCount = Object.keys(carts[restid]).length;\n  }\n  $(\"#cart-item-count\").text(cartItemCount);\n}\n\n$(\".submit-order\").click(function () {\n  $(\"#submit-cart\").removeAttr(\"style\");\n  var orderItem = $(this).closest(\".order-item\");\n  var quantity = orderItem.find(\".order-quantity\").val();\n  var id = orderItem.find(\".submit-order\").val();\n  var price = orderItem.find(\".card-text\").text();\n  var name = orderItem.find(\".foodname\").text();\n  restid = orderItem.find(\".restid\").text();\n\n  if (!carts[restid]) {\n    carts[restid] = {};\n  }\n\n  var item = {\n    q: quantity,\n    p: price,\n    n: name,\n  };\n  carts[restid][id] = item;\n  updateCart();\n  increaseCartItemCount();\n});\n\n$(document).on(\"click\", \".remove-item\", function () {\n  var itemKey = $(this).data(\"item-key\");\n  delete carts[restid][itemKey];\n  updateCart();\n});\n\nfunction updateCart() {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  $(\"#cart-items\").empty();\n  var totalQuantity = 0;\n  var totalPrice = 0;\n\n  if (carts[restid]) {\n    Object.keys(carts[restid]).forEach((itemKey) => {\n      var item = carts[restid][itemKey];\n      var itemPrice = item.q * item.p;\n      totalQuantity += item.q;\n      totalPrice += itemPrice;\n\n      var cartItemHtml =\n        '<div class=\"cart-item shadow p-3 mb-5 bg-body rounded\">' +\n        '<li class=\"list-group-item\">Food Name: <strong>' +\n        item.n +\n        \"</strong></li>\" +\n        '<li class=\"list-group-item\">Quantity: ' +\n        item.q +\n        \"</li>\" +\n        '<li class=\"list-group-item\"> <strong> Price: Rs.' +\n        itemPrice +\n        \"</strong></li>\" +\n        '<button class=\"remove-item btn btn-danger btn-sm\" data-item-key=\"' +\n        itemKey +\n        '\">Remove</button>' +\n        \"</div>\";\n\n      $(\"#cart-items\").append(cartItemHtml);\n    });\n  }\n\n  $(\"#total-quantity\").text(totalQuantity);\n  $(\"#total-price\").text(\"Rs\" + totalPrice.toFixed(2));\n\n  updateCartItemCount();\n}\n\n$(\"#checkout\").click(function () {\n  localStorage.setItem(\"carts\", JSON.stringify(carts));\n  sessionStorage.removeItem(\"cart\");\n\n  $.ajax({\n    url: \"/resturants/\" + restid + \"/orders\",\n    method: \"POST\",\n    data: {\n      cart_items: carts[restid],\n      authenticity_token: $('meta[name=\"csrf-token\"]').attr(\"content\"),\n    },\n    success: function (response) {\n      alert(\"Added to cart successfully!\");\n      updateCartItemCount();\n      delete carts[restid];\n      localStorage.setItem(\"carts\", JSON.stringify(carts));\n    },\n    error: function (xhr, status, error) {\n      alert(\"Please add items to the cart\");\n    },\n  });\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}